<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>musicoco</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="container">
        <h2>Donnez 3 chansons :</h2>
        <form id="search-form">
        <input type="text" id="userInput" placeholder="Donnez vos musiques :">
        <button type="submit">Rechercher</button>
        </form>
        <div id="search-results">
            <!-- Les résultats de la recherche seront affichés ici -->
        </div>
        <div id="suggestions"></div>
    </div>
    

</body>
</html>

<style>
    body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background-color: #a07676;
}




.container {
    display: flex;
    justify-content: center;
    border-radius: 5px;
    border: 1px solid #080808;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    padding : 50px
}

input {
    width: 100%;
    padding : 10px;
    border: 1px solid #080808;
    border-radius: 5px;
}

#suggestions {
    margin-top: 10px;
}

</style>

<script>

fetch('http://localhost:5000/api/data' , {mode : 'no-cors'})
    .then(response => response.json())
    .then(data => {
        // Les données sont maintenant disponibles dans la variable 'data'
        console.log(data);
    })
    .catch(error => {
        console.error('Erreur lors de la récupération des données :', error);
    });

    const userInput = document.getElementById('userInput');
    const suggestions = document.getElementById('suggestions');
        const searchForm = document.getElementById('search-form');
        const searchResults = document.getElementById('search-results');

        searchForm.addEventListener('submit', async (event) => {
            console.log("todo bien");
            event.preventDefault(); // Empêcher la soumission du formulaire

            const query = userInput.value;
            const response = await  fetch(`http://localhost:5000/api/search?query=${query}`, {
        method: 'GET',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json',
        },
        mode: 'no-cors', // Active les requêtes CORS
    })

    const searchResultsItem = document.createElement('div');
                searchResultsItem.textContent = `${response.text}`;
                searchResults.appendChild(searchResultsItem);
        const data = await response.json();
        console.log(data); // Affiche la réponse JSON dans la console

        // Supprime les anciens résultats
        searchResults.innerHTML = '';

        if (data.length > 0) {
            // Traitez les données JSON et affichez-les dans searchResults
            data.forEach(item => {
                const searchResultsItem = document.createElement('div');
                searchResultsItem.textContent = `${item.Name} - ${item.Artist}`;
                searchResults.appendChild(searchResultsItem);
            });
        } else {
            // Gérez le cas où aucune donnée n'a été trouvée
            const noResultsItem = document.createElement('div');
            noResultsItem.textContent = 'Aucun résultat trouvé';
            searchResults.appendChild(noResultsItem);
        }
     
    
});

</script>