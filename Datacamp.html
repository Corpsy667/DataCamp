<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>musicoco</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="container">
        <h2>Donnez 3 chansons :</h2>
        <form id="search-form">
        <input type="text" id="userInput" placeholder="Donnez vos musiques :">
        <button type="submit">Rechercher</button>
        </form>
        <div id="suggestions"></div>
    </div>
   
    <h3> Propositions :</h3>
        <div id="search-results" class="container2">
        </div>

</body>
</html>

<style>
    body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background-color: #a07676;
    flex-direction: column;
}


.container {
    display: flex;
    justify-content: center;
    border-radius: 5px;
    border: 1px solid #080808;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    padding : 50px
}
.container2 {
    height : auto + 50px;
    justify-content: center;
    border-radius: 5px;
    border: 1px solid #080808;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    width: 1000px ;
}

input {
    width: 100%;
    padding : 10px;
    border: 1px solid #080808;
    border-radius: 5px;
}

#suggestions {
    margin-top: 10px;
}
#search-results{
    background-color: aliceblue;
    border-radius: 2px;
    border-color :#080808;
    display : inline;
    align-items: center;

}
</style>

<script>


    const userInput = document.getElementById('userInput');
    const suggestions = document.getElementById('suggestions');
        const searchForm = document.getElementById('search-form');
        const searchResults = document.getElementById('search-results');

        searchForm.addEventListener('submit', async (event) => {
            console.log("todo bien");
            event.preventDefault(); // Empêcher la soumission du formulaire

            const query = userInput.value;
            const response = await  fetch(`http://localhost:5000/api/search?query=${query}`, {
        method: 'GET',
        headers: {
            'Accept': 'application/json',
            //'Content-Type': 'application/json',
        },
        mode: 'cors', // Active les requêtes CORS
    })
    if (response.ok) {
            const jsonData = await response.json();
            const displayArea = document.getElementById("search-results");

            if (Array.isArray(jsonData)) {
                displayArea.innerHTML = ''; // Clear previous results

                jsonData.forEach(item => {
                    if (item.hasOwnProperty("Name")) {
                        const nameElement = document.createElement("p");
                        nameElement.textContent = "Name: " + item.Name;
                        displayArea.appendChild(nameElement);

                        const albumElement = document.createElement("p");
                        albumElement.textContent = "Album: " + item.Album;
                        displayArea.appendChild(albumElement);

                        const artistElement = document.createElement("p");
                        artistElement.textContent = "Artist: " + item.Artist;
                        displayArea.appendChild(artistElement);
                    }
                });
            } else {
                displayArea.textContent = "JSON data is not an array.";
            }
        }
    });
</script>